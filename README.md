uploaded from lecture for archival purpose and make it easier to follow the code
